<f:for each="{field -> shape:groupedFieldOptions()}" key="groupLabel" as="options">
    <f:if condition="{groupLabel}">
        <optgroup label="{groupLabel}">
    </f:if>
    <f:for each="{options}" as="option">
        <f:form.select.option
                selected="{option.value -> shape:inArray(haystack:field.value)}"
                value="{option.value}">{option.label}</f:form.select.option>
    </f:for>
    <f:if condition="{groupLabel}">
        </optgroup>
    </f:if>
</f:for>